{"language":"Solidity","settings":{"libraries":{},"metadata":{"useLiteralContent":true},"optimizer":{"enabled":false,"runs":200},"remappings":[],"outputSelection":{"*":{"*":["*"],"":["*"]}}},"sources":{"TinlakeSpell.sol":{"content":"// Verified using https://dapp.tools\n\n// hevm: flattened sources of src/spell.sol\npragma solidity >=0.5.15 <0.6.0;\n\n////// src/spell.sol\n// Copyright (C) 2020 Centrifuge\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <https://www.gnu.org/licenses/>.\n/* pragma solidity >=0.5.15 <0.6.0; */\n\ninterface TinlakeRootLike {\n    function relyContract(address, address) external;\n    function denyContract(address, address) external;\n}\n\ninterface NAVFeedLike {\n    function file(bytes32 name, uint value) external;\n    function file(bytes32 name, uint risk_, uint thresholdRatio_, uint ceilingRatio_, uint rate_, uint recoveryRatePD_) external;\n    function discountRate() external returns(uint);\n}\n\n// This spell changes permissions for the junior & senior memberlists & assessor wrapper\n// & changes the discount rate on the NS2 deployment\ncontract TinlakeSpell {\n\n    bool public done;\n    string constant public description = \"Tinlake Mainnet Spell\";\n\n    // MAINNET ADDRESSES\n    // The contracts in this list should correspond to a tinlake deployment\n    // https://github.com/centrifuge/tinlake-pool-config/blob/master/mainnet-production.json\n\n    // REVPOOL 1 root contracts\n    address constant public ROOT = 0x53b2d22d07E069a3b132BfeaaD275b10273d381E;\n    address constant public SENIOR_MEMBERLIST = 0x5B5CFD6E45F1407ABCb4BFD9947aBea1EA6649dA;\n    address constant public JUNIOR_MEMBERLIST = 0x42C2483EEE8c1Fe46C398Ac296C59674F9eb88CD;\n    address constant public ASSESSOR_ADMIN = 0x46470030e1c732A9C2b541189471E47661311375;\n    address constant public NAV_FEED = 0x41fAD1Eb242De19dA0206B0468763333BB6C2B3D;\n\n    // permissions to be set senior memberlist\n    address constant public SENIOR_MEMBERLIST_ADMIN1 = 0xa7Aa917b502d86CD5A23FFbD9Ee32E013015e069;                                             \n    address constant public SENIOR_MEMBERLIST_ADMIN2 = 0x440B547fa81f8b34c7558722fa79cF1b56c1bDcf;\n    address constant public SENIOR_MEMBERLIST_ADMIN_REMOVE = 0xCE30bc6d0c9e489Ab06EC6E7F703E7DB69c5fa01;\n\n    // permissions to be set junior memberlist\n    address constant public JUNIOR_MEMBERLIST_ADMIN1 = 0xa7Aa917b502d86CD5A23FFbD9Ee32E013015e069;                                             \n    address constant public JUNIOR_MEMBERLIST_ADMIN2 = 0xfEADaD6b75e6C899132587b7Cb3FEd60c8554821;\n    address constant public JUNIOR_MEMBERLIST_ADMIN3 = 0x440B547fa81f8b34c7558722fa79cF1b56c1bDcf;\n\n    // permissions assessor wrapper\n    address constant public ASSESSOR_ADMIN_ADMIN1 = 0xa7Aa917b502d86CD5A23FFbD9Ee32E013015e069;                                             \n    address constant public ASSESSOR_ADMIN_ADMIN2 = 0x440B547fa81f8b34c7558722fa79cF1b56c1bDcf;\n           \n    // new discount rate 7,5%                  \n    uint constant public discountRate = uint(1000000002378234398782343987);\n    function cast() public {\n        require(!done, \"spell-already-cast\");\n        done = true;\n        execute();\n    }\n\n    function execute() internal {\n        TinlakeRootLike root = TinlakeRootLike(address(ROOT));\n        NAVFeedLike navFeed = NAVFeedLike(address(NAV_FEED));\n   \n        // add permissions  \n        // Assessor Admin\n        root.relyContract(ASSESSOR_ADMIN, ASSESSOR_ADMIN_ADMIN1);\n        root.relyContract(ASSESSOR_ADMIN, ASSESSOR_ADMIN_ADMIN2);\n        \n        // Junior Memeberlist\n        root.relyContract(JUNIOR_MEMBERLIST, JUNIOR_MEMBERLIST_ADMIN1);\n        root.relyContract(JUNIOR_MEMBERLIST, JUNIOR_MEMBERLIST_ADMIN2);\n        root.relyContract(JUNIOR_MEMBERLIST, JUNIOR_MEMBERLIST_ADMIN3);\n\n        // Senior Memeberlist\n        root.relyContract(SENIOR_MEMBERLIST, SENIOR_MEMBERLIST_ADMIN1);\n        root.relyContract(SENIOR_MEMBERLIST, SENIOR_MEMBERLIST_ADMIN2);\n        root.denyContract(SENIOR_MEMBERLIST, SENIOR_MEMBERLIST_ADMIN_REMOVE);\n\n        // NavFeed \n        root.relyContract(NAV_FEED, address(this)); // required to file riskGroups & change discountRate\n        // change discountRate\n        navFeed.file(\"discountRate\", discountRate);\n    }   \n}\n"}}}
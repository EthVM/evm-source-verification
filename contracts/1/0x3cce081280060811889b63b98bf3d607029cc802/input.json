{"language":"Solidity","settings":{"libraries":{},"metadata":{"useLiteralContent":true},"optimizer":{"enabled":false,"runs":200},"remappings":[],"outputSelection":{"*":{"*":["*"],"":["*"]}}},"sources":{"Introspection.sol":{"content":"// SPDX-License-Identifier: MIT\r\npragma solidity 0.8.11;\r\n\r\nlibrary Introspection {\r\n  // function implementsMethodNameAndParamTypes(string memory methodName, string[])\r\n  function implementsMethodSignature(address _address, string memory _signature)\r\n    public\r\n    view\r\n    returns (bool)\r\n  {\r\n    bytes4 _selector = bytes4(keccak256(bytes(_signature)));\r\n    uint256 contractSize;\r\n    assembly {\r\n      contractSize := extcodesize(_address)\r\n    }\r\n    bytes memory code = new bytes(contractSize);\r\n    assembly {\r\n      extcodecopy(_address, add(code, 0x20), 0, contractSize)\r\n    }\r\n    uint256 ptr = 0;\r\n    while (ptr < contractSize) {\r\n      // PUSH4 0x000000 (selector)\r\n      if (code[ptr] == 0x63) {\r\n        bytes memory selectorBytes = new bytes(64);\r\n        selectorBytes[0] = code[ptr + 1];\r\n        selectorBytes[1] = code[ptr + 2];\r\n        selectorBytes[2] = code[ptr + 3];\r\n        selectorBytes[3] = code[ptr + 4];\r\n        bytes4 selector = abi.decode(selectorBytes, (bytes4));\r\n        if (selector == _selector) {\r\n          return true;\r\n        }\r\n      }\r\n      ptr++;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function implementsInterface(address _address, string[] memory _interface)\r\n    public\r\n    view\r\n    returns (bool)\r\n  {\r\n    for (uint256 methodIdx = 0; methodIdx < _interface.length; methodIdx++) {\r\n      string memory method = _interface[methodIdx];\r\n      bool methodIsImplemented = implementsMethodSignature(_address, method);\r\n      if (!methodIsImplemented) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n}"}}}
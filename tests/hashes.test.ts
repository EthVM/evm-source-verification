import { getBytecodeWithoutMetadata } from "@src/libs/utils";
import { keccak256 } from "web3-utils";
import { getOpCodes } from "@src/libs/verifications";

describe("test hashes", () => {
  // contract 0x0a0c7c7d8faa70e6d88aab1663b40da88115c228 on mainnet
  const runtimebytecode =
    "608060405234801561001057600080fd5b50600436106102b45760003560e01c806301ffc9a7146102b957806305271a2a146102e257806306fdde03146102f7578063076d948c1461030c578063081812fc1461032c578063095ea7b31461034c57806309c3dd87146103615780630e18b6811461037457806318160ddd1461037c5780631f8794331461038457806323b872dd14610397578063263f3e7e146103aa57806326782247146103bd5780632944561b146103c55780632f745c59146103cd578063426a8493146103e057806342842e0e146103f357806342966c681461040657806349a7a26d146104195780634aed53c2146104215780634d47fddb146104345780634dd18bf5146104475780634f6ccce71461045a57806354fd4d501461046d5780636352211e1461047557806369c67247146104885780636c0360eb146104a85780636f307dc3146104b057806370a08231146104b8578063728c6d2a146104cb57806375794a3c146104d357806376f10ad0146104e85780637964bce3146105085780637e2985f31461052957806386a628311461053c57806389610a091461054f5780638da5cb5b1461056257806390b5a72b1461056a57806394af25eb1461057d57806395d89b4114610592578063a22cb4651461059a578063a8800425146105ad578063abf567e1146105c0578063b88d4fde146105d3578063bbe33ea5146105e6578063bd819ccd146105f9578063bde4c3cb14610601578063becef60714610614578063c349026314610627578063c87b56dd1461063a578063d149cc301461064d578063d3b1e9a414610660578063d3ceafb914610673578063e345e0bc14610693578063e8a3d485146106a6578063e985e9c5146106ae578063ecaf82a5146106c1578063f242432a146106d4578063f851a440146106e7578063fe99049a146106ef575b600080fd5b6102cc6102c7366004614be1565b610702565b6040516102d991906151fe565b60405180910390f35b6102ea610725565b6040516102d99190615453565b6102ff61072e565b6040516102d9919061521d565b61031f61031a366004614d54565b6107c4565b6040516102d9919061540c565b61033f61033a366004614d54565b6107ff565b6040516102d99190615000565b61035f61035a36600461493f565b610861565b005b6102ff61036f366004614d54565b610937565b61035f6109c2565b61031f610aa9565b61035f6103923660046145c0565b610aba565b61035f6103a53660046146e6565b610c1a565b61031f6103b8366004614d54565b610c71565b61033f610c7c565b61033f610c8b565b61031f6103db36600461493f565b610c9a565b61035f6103ee36600461496a565b610cc3565b61035f6104013660046146e6565b610d36565b61035f610414366004614d54565b610d51565b61033f610dbf565b61035f61042f366004614847565b610dce565b61035f610442366004614897565b610e36565b61035f6104553660046145c0565b610e9f565b61031f610468366004614d54565b610f6a565b6102ff610f80565b61033f610483366004614d54565b610f9d565b61049b610496366004614dce565b610fc5565b6040516102d991906151ba565b6102ff6110ba565b61033f61111b565b61031f6104c63660046145c0565b611198565b61033f611200565b6104db611245565b6040516102d99190615442565b6104fb6104f6366004614d54565b611251565b6040516102d991906153bd565b61051b610516366004614a42565b611309565b6040516102d9929190615434565b61035f610537366004614da8565b61162a565b61031f61054a36600461499e565b61196f565b6102cc61055d366004614d54565b611a08565b61033f611a89565b61035f6105783660046145c0565b611a9d565b610585611b67565b6040516102d99190615209565b6102ff611b6c565b61035f6105a8366004614912565b611bcd565b61031f6105bb366004614d54565b611cce565b61035f6105ce366004614e38565b611ce5565b61035f6105e1366004614726565b611d4c565b61035f6105f4366004614aed565b611daa565b61033f611e4a565b61031f61060f366004614d54565b611e59565b61031f610622366004614d54565b611e6b565b61035f610635366004614e17565b611e7d565b6102ff610648366004614d54565b611e93565b61031f61065b366004614e17565b611eea565b61035f61066e366004614630565b611f02565b610686610681366004614d54565b612076565b6040516102d991906153f9565b61031f6106a1366004614d84565b612102565b6102ff61212e565b6102cc6106bc3660046145f8565b6121af565b61049b6106cf3660046145c0565b6121dd565b61031f6106e23660046147d4565b612262565b61033f6122cf565b61031f6106fd36600461478f565b6122e3565b6001600160e01b0319811660009081526033602052604090205460ff165b919050565b609a5460ff1690565b606a8054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156107ba5780601f1061078f576101008083540402835291602001916107ba565b820191906000526020600020905b81548152906001019060200180831161079d57829003601f168201915b5050505050905090565b6000805b6107d183611cce565b8110156107f9576107ef6107e86106228584611eea565b8390612304565b91506001016107c8565b50919050565b600061080a8261235c565b6108455760405162461bcd60e51b815260040180806020018281038252602c8152602001806156ed602c913960400191505060405180910390fd5b506000908152606860205260409020546001600160a01b031690565b600061086c82610f9d565b9050806001600160a01b0316836001600160a01b031614156108bf5760405162461bcd60e51b81526004018080602001828103825260218152602001806157626021913960400191505060405180910390fd5b806001600160a01b03166108d1612369565b6001600160a01b031614806108ed57506108ed816106bc612369565b6109285760405162461bcd60e51b81526004018080602001828103825260388152602001806156126038913960400191505060405180910390fd5b610932838361236d565b505050565b60d1546040516309c3dd8760e01b81526060916001600160a01b0316906309c3dd879061096890859060040161540c565b60006040518083038186803b15801561098057600080fd5b505afa158015610994573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526109bc9190810190614c09565b92915050565b609b546001600160a01b03166109d6612369565b6001600160a01b031614610a26576040805162461bcd60e51b815260206004820152601260248201527137b7363c903832b73234b7339030b236b4b760711b604482015290519081900360640190fd5b609a54609b54604080516101009093046001600160a01b039081168452909116602083015280517ff9ffabca9c8276e99321725bcb43fb076a6c66a54b7f21c4e8146d8519b417dc9281900390910190a1609b8054609a8054610100600160a81b0319166101006001600160a01b038416021790556001600160a01b0319169055565b6000610ab560666123db565b905090565b609a5461010090046001600160a01b0316610ad3612369565b6001600160a01b031614610b1b576040805162461bcd60e51b815260206004820152600a60248201526937b7363c9030b236b4b760b11b604482015290519081900360640190fd5b806001600160a01b031663060aa71e6040518163ffffffff1660e01b815260040160206040518083038186803b158015610b5457600080fd5b505afa158015610b68573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b8c9190614bc5565b610bb15760405162461bcd60e51b8152600401610ba890615367565b60405180910390fd5b60d2546040517f83e13471f78e9191627ca7b1f6e515be1905a328ba88749ea97b203d5334e97d91610bf0916001600160a01b03909116908490615129565b60405180910390a160d280546001600160a01b0319166001600160a01b0392909216919091179055565b610c2b610c25612369565b826123e6565b610c665760405162461bcd60e51b81526004018080602001828103825260318152602001806157836031913960400191505060405180910390fd5b610932838383612482565b60006109bc826125bc565b609b546001600160a01b031681565b60d0546001600160a01b031681565b6001600160a01b0382166000908152606560205260408120610cbc90836125ce565b9392505050565b610ccc82610f9d565b6001600160a01b0316610cdd612369565b6001600160a01b031614610d2b576040805162461bcd60e51b815260206004820152601060248201526f2b27232a1d1037b7363c9037bbb732b960811b604482015290519081900360640190fd5b6109328383836125da565b61093283838360405180602001604052806000815250611d4c565b610d5a81610f9d565b6001600160a01b0316610d6b612369565b6001600160a01b031614610db3576040805162461bcd60e51b815260206004820152600a60248201526937b7363c9037bbb732b960b11b604482015290519081900360640190fd5b610dbc8161269f565b50565b60d2546001600160a01b031681565b610dd78261235c565b610e22576040805162461bcd60e51b815260206004820152601760248201527674617267657420746f6b656e206e6f742065786973747360481b604482015290519081900360640190fd5b610e2f85858585856126b7565b5050505050565b610e438686868686610dce565b610e5086868585856126e0565b610e97576040805162461bcd60e51b81526020600482015260136024820152723a37903737b7102b27232a2932b1b2b4bb32b960691b604482015290519081900360640190fd5b505050505050565b609a5461010090046001600160a01b0316610eb8612369565b6001600160a01b031614610f00576040805162461bcd60e51b815260206004820152600a60248201526937b7363c9030b236b4b760b11b604482015290519081900360640190fd5b609b54604080516001600160a01b039283168152918316602083015280517fca4f2f25d0898edd99413412fb94012f9e54ec8142f9b093e7720646a95b16a99281900390910190a1609b80546001600160a01b0319166001600160a01b0392909216919091179055565b600080610f78606684612875565b509392505050565b604080518082019091526003815262322e3560e81b602082015290565b60006109bc826040518060600160405280602981526020016156746029913960669190612893565b60608161100c576040805162461bcd60e51b815260206004820152601060248201526f656d7074792073706c6974556e69747360801b604482015290519081900360640190fd5b816001600160401b038111801561102257600080fd5b5060405190808252806020026020018201604052801561104c578160200160208202803683370190505b50905060005b82811015610f785760006110646128a0565b90508083838151811061107357fe5b60200260200101818152505061109c868287878681811061109057fe5b905060200201356128c3565b6000868152609c602052604080822054928252902055600101611052565b606d8054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156107ba5780601f1061078f576101008083540402835291602001916107ba565b60d05460408051632495a59960e01b815290516000926001600160a01b031691632495a599916004808301926020929190829003018186803b15801561116057600080fd5b505afa158015611174573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ab591906145dc565b60006001600160a01b0382166111df5760405162461bcd60e51b815260040180806020018281038252602a81526020018061564a602a913960400191505060405180910390fd5b6001600160a01b03821660009081526065602052604090206109bc906123db565b60d05460408051633946369560e11b815290516000926001600160a01b03169163728c6d2a916004808301926020929190829003018186803b15801561116057600080fd5b609d5463ffffffff1681565b6112596142a9565b6020810182905261126982611e6b565b60408083019190915260d0546000848152609c60205282902054915163d3ceafb960e01b81526001600160a01b039091169163d3ceafb9916112ae919060040161540c565b60006040518083038186803b1580156112c657600080fd5b505afa1580156112da573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526113029190810190614c72565b8152919050565b60d254600090819081906001600160a01b031663a4888f17611329612369565b8d8d8d8d8d8d8d8d60405160200161134999989796959493929190615045565b6040516020818303038152906040526040518263ffffffff1660e01b8152600401611374919061538f565b602060405180830381600087803b15801561138e57600080fd5b505af11580156113a2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906113c69190614d6c565b905080156113e65760405162461bcd60e51b8152600401610ba890615265565b6001600160a01b038b1661140c5760405162461bcd60e51b8152600401610ba890615292565b6000896001600160401b0316116114355760405162461bcd60e51b8152600401610ba890615230565b6114448b8b8b8b8b8b8b61196f565b9250600061145184612076565b90508060c001516114ec5760d0546040516335f707db60e11b81526001600160a01b0390911690636bee0fb690611498908f908f908f908f908f908f908f9060040161515c565b602060405180830381600087803b1580156114b257600080fd5b505af11580156114c6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906114ea9190614d6c565b505b60d0546001600160a01b031663156e29f6611505612369565b86886040518463ffffffff1660e01b8152600401611525939291906150de565b600060405180830381600087803b15801561153f57600080fd5b505af1158015611553573d6000803e3d6000fd5b50505050611569611562612369565b8587612a14565b60d2549093506001600160a01b0316635e9d0253611585612369565b8e87878a60405160200161159d959493929190615014565b6040516020818303038152906040526040518263ffffffff1660e01b81526004016115c8919061538f565b602060405180830381600087803b1580156115e257600080fd5b505af11580156115f6573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061161a9190614d6c565b5050509850989650505050505050565b6002609e541415611682576040805162461bcd60e51b815260206004820152601f60248201527f5265656e7472616e637947756172643a207265656e7472616e742063616c6c00604482015290519081900360640190fd5b6002609e5561169083610f9d565b6001600160a01b03166116a1612369565b6001600160a01b0316146116c75760405162461bcd60e51b8152600401610ba890615314565b6116d083611e6b565b8111156116ef5760405162461bcd60e51b8152600401610ba8906152c6565b6000838152609c602052604090205461170790611a08565b61171057600080fd5b60d2546000906001600160a01b031663a4888f1761172c612369565b86868660405160200161174294939291906150b4565b6040516020818303038152906040526040518263ffffffff1660e01b815260040161176d9190615338565b602060405180830381600087803b15801561178757600080fd5b505af115801561179b573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906117bf9190614d6c565b905080156117df5760405162461bcd60e51b8152600401610ba890615265565b60d0546000858152609c602052604090819020549051630bce6ea960e31b81526001600160a01b0390921691635e737548916118219187908790600401615415565b600060405180830381600087803b15801561183b57600080fd5b505af115801561184f573d6000803e3d6000fd5b5050505061185c84611e6b565b8214156118715761186c8461269f565b61187d565b61187b8483612a3d565b505b60d2546001600160a01b0316635e9d0253611896612369565b8686866040516020016118ac94939291906150b4565b6040516020818303038152906040526040518263ffffffff1660e01b81526004016118d79190615338565b602060405180830381600087803b1580156118f157600080fd5b505af1158015611905573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906119299190614d6c565b50837f3ed1528b0fdc7c5207c1bf935e34a667e13656b9ed165260c522be0bc544f303848460405161195c929190615143565b60405180910390a250506001609e555050565b60d0546040516386a6283160e01b81526000916001600160a01b0316906386a62831906119ac908b908b908b908b908b908b908b9060040161515c565b60206040518083038186803b1580156119c457600080fd5b505afa1580156119d8573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906119fc9190614d6c565b98975050505050505050565b60d0546040516389610a0960e01b81526000916001600160a01b0316906389610a0990611a3990859060040161540c565b60206040518083038186803b158015611a5157600080fd5b505afa158015611a65573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906109bc9190614bc5565b609a5461010090046001600160a01b031690565b609a5461010090046001600160a01b0316611ab6612369565b6001600160a01b031614611afe576040805162461bcd60e51b815260206004820152600a60248201526937b7363c9030b236b4b760b11b604482015290519081900360640190fd5b60d1546040517f7bf0986207bb712ddecd4a4710d515a2b1a1daac7c309dcc1d33544189c6ade991611b3d916001600160a01b03909116908490615129565b60405180910390a160d180546001600160a01b0319166001600160a01b0392909216919091179055565b600190565b606b8054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156107ba5780601f1061078f576101008083540402835291602001916107ba565b611bd5612369565b6001600160a01b0316826001600160a01b03161415611c37576040805162461bcd60e51b815260206004820152601960248201527822a9219b99189d1030b8383937bb32903a379031b0b63632b960391b604482015290519081900360640190fd5b8060696000611c44612369565b6001600160a01b03908116825260208083019390935260409182016000908120918716808252919093529120805460ff191692151592909217909155611c88612369565b6001600160a01b03167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c318360405180821515815260200191505060405180910390a35050565b60008181526099602052604081206109bc906123db565b60d0546001600160a01b031663cab0b529611cfe612369565b84846040518463ffffffff1660e01b8152600401611d1e939291906150ff565b600060405180830381600087803b158015611d3857600080fd5b505af1158015610e97573d6000803e3d6000fd5b611d5d611d57612369565b836123e6565b611d985760405162461bcd60e51b81526004018080602001828103825260318152602001806157836031913960400191505060405180910390fd5b611da484848484612af9565b50505050565b81611ded576040805162461bcd60e51b815260206004820152600e60248201526d656d70747920746f6b656e49647360901b604482015290519081900360640190fd5b60005b82811015611da457611e14848483818110611e0757fe5b9050602002013583612b4b565b609c6000858584818110611e2457fe5b905060200201358152602001908152602001600020600090558080600101915050611df0565b60d1546001600160a01b031681565b609c6020526000908152604090205481565b60009081526097602052604090205490565b611e8f82611e89612369565b8361162a565b5050565b6060611e9e8261235c565b611eba5760405162461bcd60e51b8152600401610ba8906152ea565b60d15460405163c87b56dd60e01b81526001600160a01b039091169063c87b56dd9061096890859060040161540c565b6000828152609960205260408120610cbc90836125ce565b600054610100900460ff1680611f1b5750611f1b612d3c565b80611f29575060005460ff16155b611f645760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff16158015611f8f576000805460ff1961ff0019909116610100171660011790555b611f97612d4d565b61200c85858080601f01602080910402602001604051908101604052809392919081815260200183838082843760009201919091525050604080516020601f890181900481028201810190925287815292508791508690819084018382808284376000920191909152508b9250612df6915050565b60d080546001600160a01b03808c166001600160a01b03199283161790925560d180548b841690831617905560d28054928a1692909116919091179055612059637d96233960e11b612e26565b801561206b576000805461ff00191690555b505050505050505050565b61207e6142d0565b60d05460405163d3ceafb960e01b81526001600160a01b039091169063d3ceafb9906120ae90859060040161540c565b60006040518083038186803b1580156120c657600080fd5b505afa1580156120da573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526109bc9190810190614c72565b60008281526098602090815260408083206001600160a01b038516845260010190915290205492915050565b60d1546040805163e8a3d48560e01b815290516060926001600160a01b03169163e8a3d485916004808301926000929190829003018186803b15801561217357600080fd5b505afa158015612187573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610ab59190810190614c09565b6001600160a01b03918216600090815260696020908152604080832093909416825291909152205460ff1690565b60d05460405163ecaf82a560e01b81526060916001600160a01b03169063ecaf82a59061220e908590600401615000565b60006040518083038186803b15801561222657600080fd5b505afa15801561223a573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526109bc9190810190614b36565b6000612270868686866122e3565b905061227f86868386866126e0565b6122c6576040805162461bcd60e51b81526020600482015260136024820152723a37903737b7102b27232a2932b1b2b4bb32b960691b604482015290519081900360640190fd5b95945050505050565b609a5461010090046001600160a01b031681565b60006122ed6128a0565b90506122fc85858584866126b7565b949350505050565b600082820183811015610cbc576040805162461bcd60e51b815260206004820152601b60248201527a536166654d6174683a206164646974696f6e206f766572666c6f7760281b604482015290519081900360640190fd5b60006109bc606683612ea9565b3390565b600081815260686020526040902080546001600160a01b0319166001600160a01b03841690811790915581906123a282610f9d565b6001600160a01b03167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b60006109bc82612eb5565b60006123f18261235c565b61242c5760405162461bcd60e51b815260040180806020018281038252602c8152602001806155e6602c913960400191505060405180910390fd5b600061243783610f9d565b9050806001600160a01b0316846001600160a01b031614806124725750836001600160a01b0316612467846107ff565b6001600160a01b0316145b806122fc57506122fc81856121af565b826001600160a01b031661249582610f9d565b6001600160a01b0316146124da5760405162461bcd60e51b81526004018080602001828103825260298152602001806157196029913960400191505060405180910390fd5b6001600160a01b03821661251f5760405162461bcd60e51b815260040180806020018281038252602481526020018061559c6024913960400191505060405180910390fd5b61252a838383612eb9565b61253560008261236d565b6001600160a01b03831660009081526065602052604090206125579082612ed1565b506001600160a01b038216600090815260656020526040902061257a9082612edd565b5061258760668284612ee9565b5080826001600160a01b0316846001600160a01b031660008051602061574283398151915260405160405180910390a4505050565b6000908152609c602052604090205490565b6000610cbc8383612eff565b60008281526098602090815260408083206001600160a01b038716845260010190915290205461263c5760008281526098602090815260408220805460018101825590835291200180546001600160a01b0319166001600160a01b0385161790555b60008281526098602090815260408083206001600160a01b0387168085526001909101835292819020849055805184815290518593927f8a156bd946dc74ec284c5f4b365ce75ef2a5b9d9462b4cdb1d2400cabf136541928290030190a3505050565b6000818152609c6020526040812055610dbc81612f63565b6126c48585858585612ffd565b506000918252609c602052604080832054918352909120555050565b60006126f4856001600160a01b0316613367565b612700575060016122c6565b600061283a63b382cdcd60e01b612715612369565b8988888860405160240180866001600160a01b03168152602001856001600160a01b0316815260200184815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b8381101561278357818101518382015260200161276b565b50505050905090810190601f1680156127b05780820380516001836020036101000a031916815260200191505b509650505050505050604051602081830303815290604052906001600160e01b0319166020820180516001600160e01b0383818316178352505050506040518060400160405280601c81526020017b3737b7102b27232a2932b1b2b4bb32b91034b6b83632b6b2b73a32b960211b815250886001600160a01b031661336d9092919063ffffffff16565b9050600081806020019051602081101561285357600080fd5b50516001600160e01b03191663b382cdcd60e01b149250505095945050505050565b6000808080612884868661337c565b909450925050505b9250929050565b60006122fc8484846133f7565b609d805463ffffffff198116600163ffffffff9283169081019092161790915590565b6128d46128ce612369565b846123e6565b612924576040805162461bcd60e51b815260206004820152601c60248201527b159391950e881b9bdd081bdddb995c881b9bdc88185c1c1c9bdd995960221b604482015290519081900360640190fd5b61292d8261235c565b1561297a576040805162461bcd60e51b81526020600482015260186024820152776e657720746f6b656e20616c72656164792065786973747360401b604482015290519081900360640190fd5b60008381526097602052604090205461299390826134c1565b6000848152609760205260408120919091556129ae84610f9d565b90506129c481846129be876125bc565b8561351e565b83816001600160a01b03167ff66885c33d648fcd0d97e0f2a18e30102169c22763473af0fb716f11b4a17dd68585604051808381526020018281526020019250505060405180910390a350505050565b6000612a1e6128a0565b6000818152609c602052604090208490559050610cbc8482858561351e565b600080612a4984610f9d565b9050612a9c83604051806040016040528060118152602001706275726e2065786365737320756e69747360781b81525060976000888152602001908152602001600020546135b69092919063ffffffff16565b6000858152609760209081526040808320939093558251828152908101869052825187936001600160a01b038616926000805160206157b4833981519152929081900390910190a450505060009081526097602052604090205490565b612b04848484612482565b612b1084848484613610565b611da45760405162461bcd60e51b815260040180806020018281038252603281526020018061556a6032913960400191505060405180910390fd5b612b56611d57612369565b612ba6576040805162461bcd60e51b815260206004820152601c60248201527b159391950e881b9bdd081bdddb995c881b9bdc88185c1c1c9bdd995960221b604482015290519081900360640190fd5b80821415612bf4576040805162461bcd60e51b81526020600482015260166024820152751cd95b19881b595c99d9481b9bdd08185b1b1bddd95960521b604482015290519081900360640190fd5b612bfd816125bc565b612c06836125bc565b14612c48576040805162461bcd60e51b815260206004820152600d60248201526c0e6d8dee840dad2e6dac2e8c6d609b1b604482015290519081900360640190fd5b6000612c5383610f9d565b9050612c5e82610f9d565b6001600160a01b0316816001600160a01b031614612cb4576040805162461bcd60e51b815260206004820152600e60248201526d3737ba1039b0b6b29037bbb732b960911b604482015290519081900360640190fd5b60008381526097602052604080822054848352908220549185905290612cdb908290612304565b600084815260976020526040902055612cf384612f63565b8284836001600160a01b03167fb3ce851d16b3bbec3774d5631a3893dfa2a80e067cfad265dd594402ac3d6096846040518082815260200191505060405180910390a450505050565b6000612d4730613367565b15905090565b600054610100900460ff1680612d665750612d66612d3c565b80612d74575060005460ff16155b612daf5760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff16158015612dda576000805460ff1961ff0019909116610100171660011790555b612de2613778565b8015610dbc576000805461ff001916905550565b612e06612e01612369565b61381e565b612e118383836138e0565b5050609d805463ffffffff1916600117905550565b6001600160e01b03198082161415612e84576040805162461bcd60e51b815260206004820152601c60248201527b115490cc4d8d4e881a5b9d985b1a59081a5b9d195c999858d9481a5960221b604482015290519081900360640190fd5b6001600160e01b0319166000908152603360205260409020805460ff19166001179055565b6000610cbc8383613912565b5490565b6001600160a01b03831615610932576109328161392a565b6000610cbc83836139ac565b6000610cbc8383613a72565b60006122fc84846001600160a01b038516613abc565b81546000908210612f415760405162461bcd60e51b81526004018080602001828103825260228152602001806155486022913960400191505060405180910390fd5b826000018281548110612f5057fe5b9060005260206000200154905092915050565b6000612f6e82610f9d565b90506000612f7b836125bc565b600084815260976020908152604080832054848452609990925290912091925090612fa69085612ed1565b50600084815260976020526040812055612fbf84613b53565b604080516000808252602082018490528251879391926001600160a01b038816926000805160206157b483398151915292918290030190a450505050565b61300683610f9d565b6001600160a01b0316856001600160a01b031614613069576040805162461bcd60e51b815260206004820152601b60248201527a0e6deeae4c6ca40e8ded6cadc40deeedccae440dad2e6dac2e8c6d602b1b604482015290519081900360640190fd5b6001600160a01b0384166130c3576040805162461bcd60e51b815260206004820152601c60248201527b7472616e7366657220746f20746865207a65726f206164647265737360201b604482015290519081900360640190fd5b6130d08585858585610e2f565b846001600160a01b03166130e2612369565b6001600160a01b0316141580156131025750613100856106bc612369565b155b156131b757613182816040518060400160405280602081526020017f7472616e7366657220756e697473206578636565647320616c6c6f77616e6365815250609860008781526020019081526020016000206001016000613161612369565b6001600160a01b0316815260208101919091526040016000205491906135b6565b60008481526098602052604081206001019061319c612369565b6001600160a01b031681526020810191909152604001600020555b60408051808201825260158152747472616e736665722065786365737320756e69747360581b6020808301919091526000868152609790915291909120546132009183906135b6565b6000848152609760205260409020556132188261235c565b61323557613230848361322a866125bc565b8461351e565b61331e565b836001600160a01b031661324883610f9d565b6001600160a01b0316146132a1576040805162461bcd60e51b815260206004820152601b60248201527a0e8c2e4cecae840e8ded6cadc40deeedccae440dad2e6dac2e8c6d602b1b604482015290519081900360640190fd5b6132aa826125bc565b6132b3846125bc565b146132f5576040805162461bcd60e51b815260206004820152600d60248201526c0e6d8dee840dad2e6dac2e8c6d609b1b604482015290519081900360640190fd5b60008281526097602052604090205461330e9082612304565b6000838152609760205260409020555b82846001600160a01b0316866001600160a01b03166000805160206157b48339815191528585604051808381526020018281526020019250505060405180910390a45050505050565b3b151590565b60606122fc8484600085613c0e565b8154600090819083106133c05760405162461bcd60e51b81526004018080602001828103825260228152602001806156cb6022913960400191505060405180910390fd5b60008460000184815481106133d157fe5b906000526020600020906002020190508060000154816001015492509250509250929050565b600082815260018401602052604081205482816134925760405162461bcd60e51b81526004018080602001828103825283818151815260200191508051906020019080838360005b8381101561345757818101518382015260200161343f565b50505050905090810190601f1680156134845780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b508460000160018203815481106134a557fe5b9060005260206000209060020201600101549150509392505050565b600082821115613518576040805162461bcd60e51b815260206004820152601e60248201527f536166654d6174683a207375627472616374696f6e206f766572666c6f770000604482015290519081900360640190fd5b50900390565b6135278361235c565b61354f576135358484613d69565b600082815260996020526040902061354d9084612edd565b505b6000838152609760205260409020546135689082612304565b6000848152609760209081526040808320939093558251868152908101849052825191926001600160a01b0388169284926000805160206157b483398151915292908290030190a450505050565b600081848411156136085760405162461bcd60e51b815260206004820181815283516024840152835190928392604490910191908501908083836000831561345757818101518382015260200161343f565b505050900390565b6000613624846001600160a01b0316613367565b613630575060016122fc565b600061373e630a85bd0160e11b613645612369565b88878760405160240180856001600160a01b03168152602001846001600160a01b0316815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b838110156136ac578181015183820152602001613694565b50505050905090810190601f1680156136d95780820380516001836020036101000a031916815260200191505b5095505050505050604051602081830303815290604052906001600160e01b0319166020820180516001600160e01b03838183161783525050505060405180606001604052806032815260200161556a603291396001600160a01b038816919061336d565b9050600081806020019051602081101561375757600080fd5b50516001600160e01b031916630a85bd0160e11b1492505050949350505050565b600054610100900460ff16806137915750613791612d3c565b8061379f575060005460ff16155b6137da5760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff16158015613805576000805460ff1961ff0019909116610100171660011790555b6001609e558015610dbc576000805461ff001916905550565b600054610100900460ff16806138375750613837612d3c565b80613845575060005460ff16155b6138805760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff161580156138ab576000805460ff1961ff0019909116610100171660011790555b609a8054610100600160a81b0319166101006001600160a01b038516021790558015611e8f576000805461ff00191690555050565b6138ea8383613e84565b6138fa634d84a7d760e11b612e26565b609a805460ff191660ff929092169190911790555050565b60009081526001919091016020526040902054151590565b6000818152609860205260408120905b81548110156109325781600101600083600001838154811061395857fe5b60009182526020808320909101546001600160a01b03168352820192909252604001812055815482908290811061398b57fe5b600091825260209091200180546001600160a01b031916905560010161393a565b60008181526001830160205260408120548015613a6857835460001980830191908101906000908790839081106139df57fe5b90600052602060002001549050808760000184815481106139fc57fe5b600091825260208083209091019290925582815260018981019092526040902090840190558654879080613a2c57fe5b600190038181906000526020600020016000905590558660010160008781526020019081526020016000206000905560019450505050506109bc565b60009150506109bc565b6000613a7e8383613912565b613ab4575081546001818101845560008481526020808220909301849055845484825282860190935260409020919091556109bc565b5060006109bc565b600082815260018401602052604081205480613b21575050604080518082018252838152602080820184815286546001818101895560008981528481209551600290930290950191825591519082015586548684528188019092529290912055610cbc565b82856000016001830381548110613b3457fe5b9060005260206000209060020201600101819055506000915050610cbc565b6000613b5e82610f9d565b9050613b6c81600084612eb9565b613b7760008361236d565b6000828152606c60205260409020546002600019610100600184161502019091160415613bb5576000828152606c60205260408120613bb59161430b565b6001600160a01b0381166000908152606560205260409020613bd79083612ed1565b50613be3606683613f41565b5060405182906000906001600160a01b03841690600080516020615742833981519152908390a45050565b606082471015613c4f5760405162461bcd60e51b81526004018080602001828103825260268152602001806155c06026913960400191505060405180910390fd5b613c5885613367565b613ca9576040805162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015290519081900360640190fd5b600080866001600160a01b031685876040518082805190602001908083835b60208310613ce75780518252601f199092019160209182019101613cc8565b6001836020036101000a03801982511681845116808217855250505050505090500191505060006040518083038185875af1925050503d8060008114613d49576040519150601f19603f3d011682016040523d82523d6000602084013e613d4e565b606091505b5091509150613d5e828286613f4d565b979650505050505050565b6001600160a01b038216613dc4576040805162461bcd60e51b815260206004820181905260248201527f4552433732313a206d696e7420746f20746865207a65726f2061646472657373604482015290519081900360640190fd5b613dcd8161235c565b15613e1e576040805162461bcd60e51b815260206004820152601c60248201527b115490cdcc8c4e881d1bdad95b88185b1c9958591e481b5a5b9d195960221b604482015290519081900360640190fd5b613e2a60008383612eb9565b6001600160a01b0382166000908152606560205260409020613e4c9082612edd565b50613e5960668284612ee9565b5060405181906001600160a01b03841690600090600080516020615742833981519152908290a45050565b600054610100900460ff1680613e9d5750613e9d612d3c565b80613eab575060005460ff16155b613ee65760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff16158015613f11576000805460ff1961ff0019909116610100171660011790555b613f19613fb3565b613f21614053565b613f2b83836140f0565b8015610932576000805461ff0019169055505050565b6000610cbc83836141d5565b60608315613f5c575081610cbc565b825115613f6c5782518084602001fd5b60405162461bcd60e51b815260206004820181815284516024840152845185939192839260440191908501908083836000831561345757818101518382015260200161343f565b600054610100900460ff1680613fcc5750613fcc612d3c565b80613fda575060005460ff16155b6140155760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff16158015612de2576000805460ff1961ff0019909116610100171660011790558015610dbc576000805461ff001916905550565b600054610100900460ff168061406c575061406c612d3c565b8061407a575060005460ff16155b6140b55760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff161580156140e0576000805460ff1961ff0019909116610100171660011790555b612de26301ffc9a760e01b612e26565b600054610100900460ff16806141095750614109612d3c565b80614117575060005460ff16155b6141525760405162461bcd60e51b815260040180806020018281038252602e81526020018061569d602e913960400191505060405180910390fd5b600054610100900460ff1615801561417d576000805460ff1961ff0019909116610100171660011790555b825161419090606a90602086019061434f565b5081516141a490606b90602085019061434f565b506141b56380ac58cd60e01b612e26565b6141c5635b5e139f60e01b612e26565b613f2b63780e9d6360e01b612e26565b60008181526001830160205260408120548015613a68578354600019808301919081019060009087908390811061420857fe5b906000526020600020906002020190508087600001848154811061422857fe5b60009182526020808320845460029093020191825560019384015491840191909155835482528983019052604090209084019055865487908061426757fe5b60008281526020808220600260001990940193840201828155600190810183905592909355888152898201909252604082209190915594506109bc9350505050565b60405180606001604052806142bc6142d0565b815260200160008152602001600081525090565b6040805160e08101825260008082526020820181905291810182905260608082018390526080820181905260a082015260c081019190915290565b50805460018160011615610100020316600290046000825580601f106143315750610dbc565b601f016020900490600052602060002090810190610dbc91906143db565b828054600181600116156101000203166002900490600052602060002090601f01602090048101928261438557600085556143cb565b82601f1061439e57805160ff19168380011785556143cb565b828001600101855582156143cb579182015b828111156143cb5782518255916020019190600101906143b0565b506143d79291506143db565b5090565b5b808211156143d757600081556001016143dc565b8051610720816154ee565b60008083601f84011261440c578182fd5b5081356001600160401b03811115614422578182fd5b602083019150836020808302850101111561288c57600080fd5b600082601f83011261444c578081fd5b8151602061446161445c83615484565b615461565b828152818101908583018385028701840188101561447d578586fd5b855b858110156144a457815161449281615511565b8452928401929084019060010161447f565b5090979650505050505050565b600082601f8301126144c1578081fd5b815160206144d161445c83615484565b82815281810190858301838502870184018810156144ed578586fd5b855b858110156144a457815161450281615523565b845292840192908401906001016144ef565b805161072081615503565b600082601f83011261452f578081fd5b813561453d61445c826154a1565b818152846020838601011115614551578283fd5b816020850160208301379081016020019190915292915050565b60008083601f84011261457c578182fd5b5081356001600160401b03811115614592578182fd5b60208301915083602082850101111561288c57600080fd5b805161072081615523565b805161072081615538565b6000602082840312156145d1578081fd5b8135610cbc816154ee565b6000602082840312156145ed578081fd5b8151610cbc816154ee565b6000806040838503121561460a578081fd5b8235614615816154ee565b91506020830135614625816154ee565b809150509250929050565b60008060008060008060008060c0898b03121561464b578384fd5b8835614656816154ee565b97506020890135614666816154ee565b96506040890135614676816154ee565b9550606089013561468681615538565b945060808901356001600160401b03808211156146a1578586fd5b6146ad8c838d0161456b565b909650945060a08b01359150808211156146c5578384fd5b506146d28b828c0161456b565b999c989b5096995094979396929594505050565b6000806000606084860312156146fa578081fd5b8335614705816154ee565b92506020840135614715816154ee565b929592945050506040919091013590565b6000806000806080858703121561473b578182fd5b8435614746816154ee565b93506020850135614756816154ee565b92506040850135915060608501356001600160401b03811115614777578182fd5b6147838782880161451f565b91505092959194509250565b600080600080608085870312156147a4578182fd5b84356147af816154ee565b935060208501356147bf816154ee565b93969395505050506040820135916060013590565b600080600080600060a086880312156147eb578283fd5b85356147f6816154ee565b94506020860135614806816154ee565b9350604086013592506060860135915060808601356001600160401b0381111561482e578182fd5b61483a8882890161451f565b9150509295509295909350565b600080600080600060a0868803121561485e578283fd5b8535614869816154ee565b94506020860135614879816154ee565b94979496505050506040830135926060810135926080909101359150565b60008060008060008060c087890312156148af578384fd5b86356148ba816154ee565b955060208701356148ca816154ee565b945060408701359350606087013592506080870135915060a08701356001600160401b038111156148f9578182fd5b61490589828a0161451f565b9150509295509295509295565b60008060408385031215614924578182fd5b823561492f816154ee565b9150602083013561462581615503565b60008060408385031215614951578182fd5b823561495c816154ee565b946020939093013593505050565b60008060006060848603121561497e578081fd5b8335614989816154ee565b95602085013595506040909401359392505050565b600080600080600080600060a0888a0312156149b8578081fd5b87356149c3816154ee565b965060208801356149d381615538565b955060408801356149e381615523565b945060608801356001600160401b03808211156149fe578283fd5b614a0a8b838c016143fb565b909650945060808a0135915080821115614a22578283fd5b50614a2f8a828b016143fb565b989b979a50959850939692959293505050565b60008060008060008060008060c0898b031215614a5d578182fd5b8835614a68816154ee565b97506020890135614a7881615538565b96506040890135614a8881615523565b955060608901356001600160401b0380821115614aa3578384fd5b614aaf8c838d016143fb565b909750955060808b0135915080821115614ac7578384fd5b50614ad48b828c016143fb565b999c989b50969995989497949560a00135949350505050565b600080600060408486031215614b01578081fd5b83356001600160401b03811115614b16578182fd5b614b22868287016143fb565b909790965060209590950135949350505050565b60006020808385031215614b48578182fd5b82516001600160401b03811115614b5d578283fd5b8301601f81018513614b6d578283fd5b8051614b7b61445c82615484565b8181528381019083850185840285018601891015614b97578687fd5b8694505b83851015614bb9578051835260019490940193918501918501614b9b565b50979650505050505050565b600060208284031215614bd6578081fd5b8151610cbc81615503565b600060208284031215614bf2578081fd5b81356001600160e01b031981168114610cbc578182fd5b600060208284031215614c1a578081fd5b81516001600160401b03811115614c2f578182fd5b8201601f81018413614c3f578182fd5b8051614c4d61445c826154a1565b818152856020838501011115614c61578384fd5b6122c68260208301602086016154c2565b600060208284031215614c83578081fd5b81516001600160401b0380821115614c99578283fd5b9083019060e08286031215614cac578283fd5b614cb660e0615461565b614cbf836143f0565b8152614ccd602084016145b5565b6020820152614cde604084016145aa565b6040820152614cef606084016145aa565b6060820152608083015182811115614d05578485fd5b614d11878286016144b1565b60808301525060a083015182811115614d28578485fd5b614d348782860161443c565b60a083015250614d4660c08401614514565b60c082015295945050505050565b600060208284031215614d65578081fd5b5035919050565b600060208284031215614d7d578081fd5b5051919050565b60008060408385031215614d96578182fd5b823591506020830135614625816154ee565b600080600060608486031215614dbc578081fd5b833592506020840135614715816154ee565b600080600060408486031215614de2578081fd5b8335925060208401356001600160401b03811115614dfe578182fd5b614e0a868287016143fb565b9497909650939450505050565b60008060408385031215614e29578182fd5b50508035926020909101359150565b60008060408385031215614e4a578182fd5b82359150602083013561462581615523565b60008284526020808501945082825b85811015614e96578135614e7e81615511565b63ffffffff1687529582019590820190600101614e6b565b509495945050505050565b6000815180845260208085019450808401835b83811015614e9657815163ffffffff1687529582019590820190600101614eb4565b60008284526020808501945082825b85811015614e96578135614ef881615523565b6001600160401b031687529582019590820190600101614ee5565b15159052565b60008151808452614f318160208601602086016154c2565b601f01601f19169290920160200192915050565b80516001600160a01b0316825260208082015160ff16818401526040808301516001600160401b039081169185019190915260608084015182169085015260808084015160e091860182905280519186018290526000939081019290918491906101008801905b80841015614fce57855183168252948401946001939093019290840190614fac565b5060a0870151945087810360a0890152614fe88186614ea1565b94505050505060c0830151610f7860c0860182614f13565b6001600160a01b0391909116815260200190565b6001600160a01b03958616815293909416602084015260408301919091526060820152608081019190915260a00190565b6001600160a01b038a811682528916602082015260ff881660408201526001600160401b038716606082015260e06080820181905260009061508a9083018789614ed6565b82810360a084015261509d818688614e5c565b9150508260c08301529a9950505050505050505050565b6001600160a01b039485168152602081019390935292166040820152606081019190915260800190565b6001600160a01b039390931683526020830191909152604082015260600190565b6001600160a01b0393909316835260208301919091526001600160401b0316604082015260600190565b6001600160a01b0392831681529116602082015260400190565b6001600160a01b03929092168252602082015260400190565b6001600160a01b038816815260ff871660208201526001600160401b038616604082015260a0606082018190526000906151999083018688614ed6565b82810360808401526151ac818587614e5c565b9a9950505050505050505050565b6020808252825182820181905260009190848201906040850190845b818110156151f2578351835292840192918401916001016151d6565b50909695505050505050565b901515815260200190565b602081016003831061521757fe5b91905290565b600060208252610cbc6020830184614f19565b6020808252601b908201527a06c6174657374537461727454696d652063616e6e6f74206265203602c1b604082015260600190565b60208082526013908201527214dbdb1d995c8e881b9bdd08185b1b1bddd959606a1b604082015260600190565b6020808252601a90820152796973737565722063616e6e6f742062652030206164647265737360301b604082015260600190565b6020808252600a90820152696f76657220636c61696d60b01b604082015260600190565b60208082526010908201526f746f6b656e206e6f742065786973747360801b604082015260600190565b6020808252600a908201526937b7363c9037bbb732b960b11b604082015260600190565b6000604082526005604083015264636c61696d60d81b606083015260806020830152610cbc6080830184614f19565b6020808252600e908201526d34b73b30b634b21039b7b63b32b960911b604082015260600190565b60006040825260046040830152631b5a5b9d60e21b606083015260806020830152610cbc6080830184614f19565b6000602082528251606060208401526153d96080840182614f45565b905060208401516040840152604084015160608401528091505092915050565b600060208252610cbc6020830184614f45565b90815260200190565b9283526001600160a01b03919091166020830152604082015260600190565b918252602082015260400190565b63ffffffff91909116815260200190565b60ff91909116815260200190565b6040518181016001600160401b038111828210171561547c57fe5b604052919050565b60006001600160401b0382111561549757fe5b5060209081020190565b60006001600160401b038211156154b457fe5b50601f01601f191660200190565b60005b838110156154dd5781810151838201526020016154c5565b83811115611da45750506000910152565b6001600160a01b0381168114610dbc57600080fd5b8015158114610dbc57600080fd5b63ffffffff81168114610dbc57600080fd5b6001600160401b0381168114610dbc57600080fd5b60ff81168114610dbc57600080fdfe456e756d657261626c655365743a20696e646578206f7574206f6620626f756e64734552433732313a207472616e7366657220746f206e6f6e20455243373231526563656976657220696d706c656d656e7465724552433732313a207472616e7366657220746f20746865207a65726f2061646472657373416464726573733a20696e73756666696369656e742062616c616e636520666f722063616c6c4552433732313a206f70657261746f7220717565727920666f72206e6f6e6578697374656e7420746f6b656e4552433732313a20617070726f76652063616c6c6572206973206e6f74206f776e6572206e6f7220617070726f76656420666f7220616c6c4552433732313a2062616c616e636520717565727920666f7220746865207a65726f20616464726573734552433732313a206f776e657220717565727920666f72206e6f6e6578697374656e7420746f6b656e496e697469616c697a61626c653a20636f6e747261637420697320616c726561647920696e697469616c697a6564456e756d657261626c654d61703a20696e646578206f7574206f6620626f756e64734552433732313a20617070726f76656420717565727920666f72206e6f6e6578697374656e7420746f6b656e4552433732313a207472616e73666572206f6620746f6b656e2074686174206973206e6f74206f776eddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef4552433732313a20617070726f76616c20746f2063757272656e74206f776e65724552433732313a207472616e736665722063616c6c6572206973206e6f74206f776e6572206e6f7220617070726f766564823a343d1c899e61a4db12247636a6882bf1fefae78bef39170f8d0f5b53e456a2646970667358221220bf41e5a64eb5d250aa4769193d6c3ca4ebd74cc84206f52c35292fbd60037d3864736f6c63430007060033";
  it("should calculate runtime hash", () => {
    const runtimeHash = keccak256(`0x${runtimebytecode}`);
    expect(runtimeHash).toEqual(
      "0x97afed562022169646947e954ce1b9710477f2422c738fda44be73cb96fe9079"
    );
  });
  it("should calculate metaless hash", () => {
    const metalessHash = keccak256(
      `0x${getBytecodeWithoutMetadata(runtimebytecode)}`
    );
    expect(metalessHash).toEqual(
      "0xff5d4a6d45c983baed19242533024214e969ea4e2d7881f0915e3f6ada2a5075"
    );
  });
  it("should calculate opcode hash", () => {
    const liveOpCodes = getOpCodes(
      Buffer.from(getBytecodeWithoutMetadata(runtimebytecode), "hex")
    );
    const opcodeHash = keccak256(
      `0x${Buffer.from(liveOpCodes.map((opcode) => opcode.byte)).toString(
        "hex"
      )}`
    );
    expect(opcodeHash).toEqual(
      "0x82647eb91c2f0b8df3423edb54212f89881ab5be65c7198a07a913d403418624"
    );
  });
});
